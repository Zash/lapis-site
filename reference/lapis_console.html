<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Lapis Console - Lapis Reference Manual</title>
  <link rel="stylesheet" href="../reference.css?Wed Dec 14 00:10:32 2022" />
  <script type="text/javascript">
  if (window.location.hostname != "localhost") {
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-136625-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  }
</script>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
</head>
<body>
  <div class="header">
    <button class="toggle_nav_btn" id="menu_toggle">Menu</button>
    <h1>
      <a href="..">Lapis</a>
    </h1>
    <div id="search_drop" data-root=".." data-index="../reference.json"></div>
    <a href="../changelog.html" class="version_flag">
      v1.11.0
    </a>
  </div>

  <div class="columns">
    <div class="nav_column">
      <div class="scrolling_inner">
        <div class="lang_picker">
          <span class="lang_toggle active" data-lang="moonscript">MoonScript</span>
          <span class="lang_toggle" data-lang="lua">Lua</span>
        </div>

        
          <div class="nav_links">
            <h2>Contents</h2>
            <ul><li><a href="#creating-a-console">Creating A Console</a></li>
<ul><li><a href="#creating-a-console/console.make"><code>console.make([opts])</code></a></li></ul>
<li><a href="#tips">Tips</a></li></ul>
          </div>
        

        <div class="nav_links">
          <h2>All Guides</h2>

<ul>
<li><a href="../reference/getting_started.html">Getting Started</a>

<ul>
<li><a href="../reference/moon_getting_started.html">Getting Started With MoonScript</a></li>
<li><a href="../reference/lua_getting_started.html">Getting Started With Lua</a></li>
</ul>
</li>
<li><a href="../reference/actions.html">Requests and Actions</a></li>
<li><a href="../reference/configuration.html">Writing Configurations</a>

<ul>
<li><a href="../reference/lua_creating_configurations.html">Lua configuration syntax</a></li>
<li><a href="../reference/moon_creating_configurations.html">MoonScript configuration syntax</a></li>
</ul>
</li>
<li><a href="../reference/database.html">Database Access, and Queries</a>

<ul>
<li><a href="../reference/models.html">Models</a></li>
</ul>
</li>
<li><a href="../reference/exception_handling.html">Handling Exceptions</a></li>
<li><a href="../reference/input_validation.html">Input Validation</a></li>
<li><a href="../reference/html_generation.html">HTML Generation</a></li>
<li><a href="../reference/etlua_templates.html">etlua Templates</a></li>
<li><a href="../reference/testing.html">Testing</a></li>
<li><a href="../reference/utilities.html">Utility Functions</a></li>
<li><a href="../reference/command_line.html">Command Line Tool</a></li>
<li><a href="../reference/lapis_console.html">Lapis Console</a></li>
</ul>


        </div>

      </div>
    </div>

    <div class="nav_offset">
      <div class="text_column"><h1>Lapis Console</h1>

<p><a href="https://github.com/leafo/lapis-console">Lapis Console</a> is a separate project that adds an interactive console to
your web application. Because Lapis runs inside of the Nginx loop, it&rsquo;s not
trivial to make a standard terminal based console that behaves the same way as
the web application. So a console that runs inside of your browser was created,
letting you reliably execute code in the same way as your web application when
debugging.</p>

<p><img src="http://leafo.net/dump/lapis_console.png" title="Screenshot of the Lapis Console exploring an object." alt="Lapis Console Screenshot" /></p>

<p>Install through LuaRocks:</p>

<pre class="highlight lang_bash"><code><span></span>$ luarocks install lapis-console</code>
</pre>


<h2><a name="creating-a-console" href="#creating-a-console">Creating A Console</a></h2>

<h3><a name="creating-a-console/console.make" href="#creating-a-console/console.make"><code>console.make([opts])</code></a></h3>

<p>Lapis console provides an action that you can insert into your application to a
route of your choosing:</p>

<pre class="highlight lang_lua"><code><span></span><span class="kd">local</span> <span class="n">lapis</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">&quot;lapis&quot;</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">console</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">&quot;lapis.console&quot;</span><span class="p">)</span>

<span class="kd">local</span> <span class="n">app</span> <span class="o">=</span> <span class="n">lapis</span><span class="p">.</span><span class="n">Application</span><span class="p">()</span>

<span class="n">app</span><span class="p">:</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;/console&quot;</span><span class="p">,</span> <span class="n">console</span><span class="p">.</span><span class="n">make</span><span class="p">())</span>

<span class="kr">return</span> <span class="n">app</span></code>
</pre>


<pre class="highlight lang_moon"><code><span></span><span class="n">lapis</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;</span><span class="s">lapis</span><span class="s2">&quot;</span><span class="w"></span>
<span class="n">console</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;</span><span class="s">lapis.console</span><span class="s2">&quot;</span><span class="w"></span>

<span class="k">class</span> <span class="k">extends</span> <span class="n">lapis</span><span class="o">.</span><span class="n">Application</span><span class="w"></span>
  <span class="s2">&quot;</span><span class="s">/console</span><span class="s2">&quot;</span><span class="o">:</span> <span class="n">console</span><span class="o">.</span><span class="n">make</span><span class="o">!</span><span class="w"></span></code>
</pre>


<p>Now just head to to the <code>/console</code> location in your browser to use it. By
default the action that is created will only run in the <code>"development"</code>
environment.</p>

<p>You can set the <code>env</code> option in the first argument to <code>"all"</code> to enable in
every environment, or you can name an environment.</p>

<blockquote><p>Be careful about allowing access to the console, a malicious individual could
destroy your application and compromise your system if given access.</p></blockquote>

<h2><a name="tips" href="#tips">Tips</a></h2>

<p>The console lets your write and execute a MoonScript program. Multiple lines
are supported.</p>

<p>The <code>print</code> function has been replaced in the console to print to the debug
output. You can print any type of object and the console will pretty print it.
Tables can be opened up and other types are color coded.</p>

<p>Any queries that execute during the script are logged to a special portion on
the bottom of the output.</p>

<p><code>@</code> is equal to the value of the request that is initiating the console. You
can use this if you are testing a method that needs a request object.</p>

      </div>
    </div>

  </div>

  <script src="../lib/jquery.min.js"></script>
  <script src="../lib/react.production.min.js"></script>
  <script src="../lib/react-dom.production.min.js"></script>
  <script src="../lib/react-dom-factories.js"></script>
  <script src="../lib/lunr.min.js"></script>
  <script type="text/javascript" src="../search.js?Wed Dec 14 00:10:32 2022"></script>
  <script type="text/javascript" src="../reference.js?Wed Dec 14 00:10:32 2022"></script>
  <script type="text/javascript">
    new L.Reference();
  </script>
</body>
</html>
