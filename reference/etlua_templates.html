<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>etlua Templates - Lapis Reference Manual</title>
  <link rel="stylesheet" href="../reference.css?Thu Dec 15 21:53:36 2022" />
  <script type="text/javascript">
  if (window.location.hostname != "localhost") {
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-136625-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  }
</script>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
</head>
<body>
  <div class="header">
    <button class="toggle_nav_btn" id="menu_toggle">Menu</button>
    <h1>
      <a href="..">Lapis</a>
    </h1>
    <div id="search_drop" data-root=".." data-index="../reference.json"></div>
    <a href="../changelog.html" class="version_flag">
      v1.11.0
    </a>
  </div>

  <div class="columns">
    <div class="nav_column">
      <div class="scrolling_inner">
        <div class="lang_picker">
          <span class="lang_toggle active" data-lang="lua">Lua</span>
          <span class="lang_toggle" data-lang="moonscript">MoonScript</span>
        </div>

        
          <div class="nav_links">
            <h2>etlua Templates</h2>
            <ul><li><a href="#rendering-from-actions">Rendering From Actions</a></li>
<ul><li><a href="#rendering-from-actions/passing-values-to-views">Passing Values to Views</a></li></ul>
<li><a href="#calling-helper-functions-from-views">Calling Helper Functions from Views</a></li>
<li><a href="#rendering-sub-templates">Rendering Sub-templates</a></li>
<li><a href="#view-helper-functions">View Helper Functions</a></li></ul>
          </div>
        

        <div class="nav_links">
          <h2>All Guides</h2>

<ul>
<li><a href="../reference/getting_started.html">Getting Started</a>

<ul>
<li><a href="../reference/lua_getting_started.html">Getting Started With Lua</a></li>
<li><a href="../reference/moon_getting_started.html">Getting Started With MoonScript</a></li>
</ul>
</li>
<li><a href="../reference/actions.html">Requests and Actions</a></li>
<li><a href="../reference/configuration.html">Writing Configurations</a>

<ul>
<li><a href="../reference/lua_creating_configurations.html">Lua configuration syntax</a></li>
<li><a href="../reference/moon_creating_configurations.html">MoonScript configuration syntax</a></li>
</ul>
</li>
<li><a href="../reference/database.html">Database Access, and Queries</a>

<ul>
<li><a href="../reference/models.html">Models</a></li>
</ul>
</li>
<li><a href="../reference/exception_handling.html">Handling Exceptions</a></li>
<li><a href="../reference/input_validation.html">Input Validation</a></li>
<li><a href="../reference/html_generation.html">HTML Generation</a></li>
<li><a href="../reference/etlua_templates.html">etlua Templates</a></li>
<li><a href="../reference/testing.html">Testing</a></li>
<li><a href="../reference/utilities.html">Utility Functions</a></li>
<li><a href="../reference/command_line.html">Command Line Tool</a></li>
<li><a href="../reference/lapis_console.html">Lapis Console</a></li>
</ul>


        </div>

      </div>
    </div>

    <div class="nav_offset">
      <div class="text_column"><h1><code>etlua</code> Templates</h1>

<p><a href="https://github.com/leafo/etlua"><code>etlua</code></a> is a templating language that lets you render the result of Lua
code inline in a template file to produce a dynamic output. In Lapis we use
<code>etlua</code> to render dynamic content inside of HTML templates.</p>

<p><code>etlua</code> files use the <code>.etlua</code> extension. Lapis knows how to load those types
of files automatically using Lua&rsquo;s <code>require</code> function after you've enabled
<code>etlua</code></p>

<p>For example, here&rsquo;s a simple template that renders a random number:</p>

<pre class="highlight lang_erb"><code><span class="sh_comment">&lt;!-- views/hello.etlua --&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;div</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_attribute sh_type">class</span><span class="sh_default">=</span><span class="sh_string">&quot;my_page&quot;</span><span class="sh_element sh_keyword">&gt;</span><span class="sh_html_whitespace sh_whitespace">
  </span><span class="sh_default">Here</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">is</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">a</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">random</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">number:</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_rhtml_tag sh_embedded">&lt;%=</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_identifier">math</span><span class="sh_operator">.</span><span class="sh_identifier">random</span><span class="sh_operator">()</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_rhtml_tag sh_embedded">%&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;/div&gt;</span></code>
</pre>


<p><code>etlua</code> comes with the following tags for injecting Lua into your templates:</p>

<ul>
<li><code>&lt;% lua_code %&gt;</code> runs Lua code verbatim</li>
<li><code>&lt;%= lua_expression %&gt;</code> writes result of expression to output, HTML escaped</li>
<li><code>&lt;%- lua_expression %&gt;</code> same as above but with no HTML escaping</li>
</ul>


<h2><a name="rendering-from-actions" href="#rendering-from-actions">Rendering From Actions</a></h2>

<p>An <em>action</em> is a function that handles a request that matches a particular
route. An action should perform logic and prepare data before forwarding to a
view or triggering a render. Actions can control how the result is rendered by
returning a table of options.</p>

<p>The <code>render</code> option of the return value of an action lets us specify which
template to render after the action is executed. If we place an <code>.etlua</code> file
inside of the views directory, <code>views/</code> by default, then we can render a
template by name like so:</p>

<pre class="highlight lang_lua"><code><span class="sh_keyword">local</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_identifier">lapis</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">=</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_function">require</span><span class="sh_operator">(</span><span class="sh_string">&quot;lapis&quot;</span><span class="sh_operator">)</span><span class="sh_lua_whitespace sh_whitespace">

</span><span class="sh_keyword">local</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_identifier">app</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">=</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_identifier">lapis</span><span class="sh_operator">.</span><span class="sh_identifier">Application</span><span class="sh_operator">()</span><span class="sh_lua_whitespace sh_whitespace">
</span><span class="sh_identifier">app</span><span class="sh_operator">:</span><span class="sh_identifier">enable</span><span class="sh_operator">(</span><span class="sh_string">&quot;etlua&quot;</span><span class="sh_operator">)</span><span class="sh_lua_whitespace sh_whitespace">

</span><span class="sh_identifier">app</span><span class="sh_operator">:</span><span class="sh_identifier">match</span><span class="sh_operator">(</span><span class="sh_string">&quot;/&quot;</span><span class="sh_operator">,</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_keyword">function</span><span class="sh_operator">()</span><span class="sh_lua_whitespace sh_whitespace">
  </span><span class="sh_keyword">return</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">{</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_identifier">render</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">=</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_string">&quot;hello&quot;</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">}</span><span class="sh_lua_whitespace sh_whitespace">
</span><span class="sh_keyword">end</span><span class="sh_operator">)</span><span class="sh_lua_whitespace sh_whitespace">

</span><span class="sh_keyword">return</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_identifier">app</span></code>
</pre>


<pre class="highlight lang_moon"><code><span class="sh_identifier">lapis</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_operator">=</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_function">require</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_string">&quot;lapis&quot;</span><span class="sh_moonscript_whitespace sh_whitespace">

</span><span class="sh_keyword">class</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_proper_ident sh_class">App</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_keyword">extends</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_identifier">lapis</span><span class="sh_operator">.</span><span class="sh_proper_ident sh_class">Application</span><span class="sh_moonscript_whitespace sh_whitespace">
  </span><span class="sh_self_ref sh_label">@enable</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_string">&quot;etlua&quot;</span><span class="sh_moonscript_whitespace sh_whitespace">
  </span><span class="sh_string">&quot;/&quot;</span><span class="sh_operator">:</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_fndef sh_preprocessor">=&gt;</span><span class="sh_moonscript_whitespace sh_whitespace">
    </span><span class="sh_tbl_key sh_regex">render:</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_string">&quot;hello&quot;</span></code>
</pre>


<p>Rendering <code>"hello"</code> will cause the module <code>"views.hello"</code> to load, which will
resolve our <code>etlua</code> template located at <code>views/hello.etlua</code></p>

<p>Because it&rsquo;s common to have a single view for every (or most actions) you can
avoid repeating the name of the view when using a named route. A named route&rsquo;s
action can just set <code>true</code> to the <code>render</code> option and the name of the route
will be used as the name of the template:</p>

<pre class="highlight lang_lua"><code><span class="sh_keyword">local</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_identifier">lapis</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">=</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_function">require</span><span class="sh_operator">(</span><span class="sh_string">&quot;lapis&quot;</span><span class="sh_operator">)</span><span class="sh_lua_whitespace sh_whitespace">

</span><span class="sh_keyword">local</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_identifier">app</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">=</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_identifier">lapis</span><span class="sh_operator">.</span><span class="sh_identifier">Application</span><span class="sh_operator">()</span><span class="sh_lua_whitespace sh_whitespace">
</span><span class="sh_identifier">app</span><span class="sh_operator">:</span><span class="sh_identifier">enable</span><span class="sh_operator">(</span><span class="sh_string">&quot;etlua&quot;</span><span class="sh_operator">)</span><span class="sh_lua_whitespace sh_whitespace">

</span><span class="sh_identifier">app</span><span class="sh_operator">:</span><span class="sh_identifier">match</span><span class="sh_operator">(</span><span class="sh_string">&quot;index&quot;</span><span class="sh_operator">,</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_string">&quot;/&quot;</span><span class="sh_operator">,</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_keyword">function</span><span class="sh_operator">()</span><span class="sh_lua_whitespace sh_whitespace">
  </span><span class="sh_keyword">return</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">{</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_identifier">render</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">=</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_keyword">true</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">}</span><span class="sh_lua_whitespace sh_whitespace">
</span><span class="sh_keyword">end</span><span class="sh_operator">)</span><span class="sh_lua_whitespace sh_whitespace">

</span><span class="sh_keyword">return</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_identifier">app</span></code>
</pre>


<pre class="highlight lang_moon"><code><span class="sh_identifier">lapis</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_operator">=</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_function">require</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_string">&quot;lapis&quot;</span><span class="sh_moonscript_whitespace sh_whitespace">

</span><span class="sh_keyword">class</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_proper_ident sh_class">App</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_keyword">extends</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_identifier">lapis</span><span class="sh_operator">.</span><span class="sh_proper_ident sh_class">Application</span><span class="sh_moonscript_whitespace sh_whitespace">
  </span><span class="sh_self_ref sh_label">@enable</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_string">&quot;etlua&quot;</span><span class="sh_moonscript_whitespace sh_whitespace">
  </span><span class="sh_symbol sh_embedded">[</span><span class="sh_tbl_key sh_regex">index:</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_string">&quot;/&quot;</span><span class="sh_symbol sh_embedded">]</span><span class="sh_operator">:</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_fndef sh_preprocessor">=&gt;</span><span class="sh_moonscript_whitespace sh_whitespace">
    </span><span class="sh_tbl_key sh_regex">render:</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_keyword">true</span></code>
</pre>


<pre class="highlight lang_html"><code><span class="sh_comment">&lt;!-- views/index.etlua --&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;div</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_attribute sh_type">class</span><span class="sh_default">=</span><span class="sh_string">&quot;index&quot;</span><span class="sh_element sh_keyword">&gt;</span><span class="sh_html_whitespace sh_whitespace">
  </span><span class="sh_default">Welcome</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">to</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">the</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">index</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">of</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">my</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">site!</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;/div&gt;</span></code>
</pre>


<h3><a name="rendering-from-actions/passing-values-to-views" href="#rendering-from-actions/passing-values-to-views">Passing Values to Views</a></h3>

<p>Values can be passed to views by setting them on <code>self</code> in the action. For
example we might set some state for a template like so:</p>

<pre class="highlight lang_lua"><code><span class="sh_identifier">app</span><span class="sh_operator">:</span><span class="sh_identifier">match</span><span class="sh_operator">(</span><span class="sh_string">&quot;/&quot;</span><span class="sh_operator">,</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_keyword">function</span><span class="sh_operator">(</span><span class="sh_identifier">self</span><span class="sh_operator">)</span><span class="sh_lua_whitespace sh_whitespace">
  </span><span class="sh_identifier">self</span><span class="sh_operator">.</span><span class="sh_identifier">pets</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">=</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">{</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_string">&quot;Cat&quot;</span><span class="sh_operator">,</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_string">&quot;Dog&quot;</span><span class="sh_operator">,</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_string">&quot;Bird&quot;</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">}</span><span class="sh_lua_whitespace sh_whitespace">
  </span><span class="sh_keyword">return</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">{</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_identifier">render</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">=</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_string">&quot;my_template&quot;</span><span class="sh_lua_whitespace sh_whitespace"> </span><span class="sh_operator">}</span><span class="sh_lua_whitespace sh_whitespace">
</span><span class="sh_keyword">end</span><span class="sh_operator">)</span></code>
</pre>


<pre class="highlight lang_moon"><code><span class="sh_keyword">class</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_proper_ident sh_class">App</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_keyword">extends</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_identifier">lapis</span><span class="sh_operator">.</span><span class="sh_proper_ident sh_class">Application</span><span class="sh_moonscript_whitespace sh_whitespace">
  </span><span class="sh_self_ref sh_label">@enable</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_string">&quot;etlua&quot;</span><span class="sh_moonscript_whitespace sh_whitespace">
  </span><span class="sh_string">&quot;/&quot;</span><span class="sh_operator">:</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_fndef sh_preprocessor">=&gt;</span><span class="sh_moonscript_whitespace sh_whitespace">
    </span><span class="sh_self_ref sh_label">@pets</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_operator">=</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_symbol sh_embedded">{</span><span class="sh_string">&quot;Cat&quot;</span><span class="sh_operator">,</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_string">&quot;Dog&quot;</span><span class="sh_operator">,</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_string">&quot;Bird&quot;</span><span class="sh_symbol sh_embedded">}</span><span class="sh_moonscript_whitespace sh_whitespace">
    </span><span class="sh_tbl_key sh_regex">render:</span><span class="sh_moonscript_whitespace sh_whitespace"> </span><span class="sh_string">&quot;my_template&quot;</span></code>
</pre>


<pre class="highlight lang_erb"><code><span class="sh_comment">&lt;!-- views/my_template.etlua --&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;ul</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_attribute sh_type">class</span><span class="sh_default">=</span><span class="sh_string">&quot;list&quot;</span><span class="sh_element sh_keyword">&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_rhtml_tag sh_embedded">&lt;%</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_keyword">for</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_identifier">i</span><span class="sh_operator">,</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_identifier">item</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_keyword">in</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_identifier">ipairs</span><span class="sh_operator">(</span><span class="sh_identifier">pets</span><span class="sh_operator">)</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_keyword">do</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_rhtml_tag sh_embedded">%&gt;</span><span class="sh_html_whitespace sh_whitespace">
  </span><span class="sh_element sh_keyword">&lt;li&gt;</span><span class="sh_rhtml_tag sh_embedded">&lt;%=</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_identifier">item</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_rhtml_tag sh_embedded">%&gt;</span><span class="sh_element sh_keyword">&lt;/li&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_rhtml_tag sh_embedded">&lt;%</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_keyword">end</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_rhtml_tag sh_embedded">%&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;/ul&gt;</span></code>
</pre>


<p>You'll notice that we don&rsquo;t need to refer scope the values with <code>self</code> when
retrieving their values in the template. Any variables are automatically looked
up in that table by default.</p>

<h2><a name="calling-helper-functions-from-views" href="#calling-helper-functions-from-views">Calling Helper Functions from Views</a></h2>

<p>Helper functions can be called just as if they were in scope when inside of a
template. A common helper is the <code>url_for</code> function which helps us generate a
URL to a named route:</p>

<pre class="highlight lang_erb"><code><span class="sh_comment">&lt;!-- views/about.etlua --&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;div</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_attribute sh_type">class</span><span class="sh_default">=</span><span class="sh_string">&quot;about_page&quot;</span><span class="sh_element sh_keyword">&gt;</span><span class="sh_html_whitespace sh_whitespace">
  </span><span class="sh_element sh_keyword">&lt;p&gt;</span><span class="sh_default">This</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">is</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">a</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">great</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">page!</span><span class="sh_element sh_keyword">&lt;/p&gt;</span><span class="sh_html_whitespace sh_whitespace">
  </span><span class="sh_element sh_keyword">&lt;p&gt;</span><span class="sh_html_whitespace sh_whitespace">
    </span><span class="sh_element sh_keyword">&lt;a</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_attribute sh_type">href</span><span class="sh_default">=</span><span class="sh_string">&quot;&lt;%= url_for(&quot;</span><span class="sh_default">index&quot;)</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">%</span><span class="sh_element sh_keyword">&gt;</span><span class="sh_default">&quot;</span><span class="sh_element sh_keyword">&gt;</span><span class="sh_default">Return</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">home</span><span class="sh_element sh_keyword">&lt;/a&gt;</span><span class="sh_html_whitespace sh_whitespace">
  </span><span class="sh_element sh_keyword">&lt;/p&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;/div&gt;</span></code>
</pre>


<p>Any method available on the request object (<code>self</code> in an action) can be called
in the template. It will be called with the correct receiver automatically.</p>

<p>Additionally <code>etlua</code> templates have a couple of helper functions only defined in
the context of the template. They are covered below.</p>

<h2><a name="rendering-sub-templates" href="#rendering-sub-templates">Rendering Sub-templates</a></h2>

<p>A sub-template is a template that is rendered inside of another template. For example
you might have a common navigation across many pages so you would create a
template for the navigation&rsquo;s HTML and include it in the templates that require
a navigation.</p>

<p>To render a sub-template you can use the <code>render</code> helper function:</p>

<pre class="highlight lang_erb"><code><span class="sh_comment">&lt;!-- views/navigation.etlua --&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;div</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_attribute sh_type">class</span><span class="sh_default">=</span><span class="sh_string">&quot;nav_bar&quot;</span><span class="sh_element sh_keyword">&gt;</span><span class="sh_html_whitespace sh_whitespace">
  </span><span class="sh_element sh_keyword">&lt;a</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_attribute sh_type">href</span><span class="sh_default">=</span><span class="sh_string">&quot;&lt;%= url_for(&quot;</span><span class="sh_default">index&quot;)</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">%</span><span class="sh_element sh_keyword">&gt;</span><span class="sh_default">&quot;</span><span class="sh_element sh_keyword">&gt;</span><span class="sh_default">Home</span><span class="sh_element sh_keyword">&lt;/a&gt;</span><span class="sh_html_whitespace sh_whitespace">
  </span><span class="sh_element sh_keyword">&lt;a</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_attribute sh_type">href</span><span class="sh_default">=</span><span class="sh_string">&quot;&lt;%= url_for(&quot;</span><span class="sh_default">about&quot;)</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_default">%</span><span class="sh_element sh_keyword">&gt;</span><span class="sh_default">&quot;</span><span class="sh_element sh_keyword">&gt;</span><span class="sh_default">About</span><span class="sh_element sh_keyword">&lt;/a&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;/div&gt;</span></code>
</pre>


<pre class="highlight lang_erb"><code><span class="sh_comment">&lt;!-- views/index.etlua --&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;div</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_attribute sh_type">class</span><span class="sh_default">=</span><span class="sh_string">&quot;page&quot;</span><span class="sh_element sh_keyword">&gt;</span><span class="sh_html_whitespace sh_whitespace">
  </span><span class="sh_rhtml_tag sh_embedded">&lt;%</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_function">render</span><span class="sh_operator">(</span><span class="sh_string">&quot;views.navigation&quot;</span><span class="sh_operator">)</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_rhtml_tag sh_embedded">%&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;/div&gt;</span></code>
</pre>


<p>Note that you have to type the full module name of the template for the first
argument to require, in this case <code>"views.navigation"</code>, which points to
<code>views/navigation.etlua</code>. If you happen to also be using MoonScript templates
you can also include them using the <code>render</code> function.</p>

<p>Any values and helpers available in the parent template are also available in
the sub-template.</p>

<p>Sometimes you need to pass data to a sub-template that&rsquo;s generated during the
execution of the parent template. <code>render</code> takes a second argument of values
to pass into the sub-template.</p>

<p>Here&rsquo;s a contrived example of using a sub-template to render a list of numbers:</p>

<pre class="highlight lang_erb"><code><span class="sh_comment">&lt;!-- templates/list_item.etlua --&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;div</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_attribute sh_type">class</span><span class="sh_default">=</span><span class="sh_string">&quot;list_item&quot;</span><span class="sh_element sh_keyword">&gt;</span><span class="sh_html_whitespace sh_whitespace">
  </span><span class="sh_rhtml_tag sh_embedded">&lt;%=</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_identifier">number_value</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_rhtml_tag sh_embedded">%&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;/div&gt;</span></code>
</pre>


<pre class="highlight lang_erb"><code><span class="sh_comment">&lt;!-- templates/list.etlua --&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;div</span><span class="sh_html_whitespace sh_whitespace"> </span><span class="sh_attribute sh_type">class</span><span class="sh_default">=</span><span class="sh_string">&quot;list&quot;</span><span class="sh_element sh_keyword">&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_rhtml_tag sh_embedded">&lt;%</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_keyword">for</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_identifier">i</span><span class="sh_operator">,</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_identifier">value</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_keyword">in</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_identifier">ipairs</span><span class="sh_operator">({})</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_keyword">do</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_rhtml_tag sh_embedded">%&gt;</span><span class="sh_html_whitespace sh_whitespace">
  </span><span class="sh_rhtml_tag sh_embedded">&lt;%</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_function">render</span><span class="sh_operator">(</span><span class="sh_string">&quot;templates.list_item&quot;</span><span class="sh_operator">,</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_operator">{</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_identifier">number_value</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_operator">=</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_identifier">value</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_operator">})</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_rhtml_tag sh_embedded">%&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_rhtml_tag sh_embedded">&lt;%</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_keyword">end</span><span class="sh_ruby_whitespace sh_whitespace"> </span><span class="sh_rhtml_tag sh_embedded">%&gt;</span><span class="sh_html_whitespace sh_whitespace">
</span><span class="sh_element sh_keyword">&lt;/div&gt;</span></code>
</pre>


<h2><a name="view-helper-functions" href="#view-helper-functions">View Helper Functions</a></h2>

<ul>
<li><code>render(template_name, [template_params])</code> &mdash; loads and renders a template</li>
<li><code>widget(widget_instance)</code> &mdash; renders and instance of a <code>Widget</code></li>
</ul>


      </div>
    </div>

  </div>

  <script src="../lib/jquery.min.js"></script>
  <script src="../lib/react.production.min.js"></script>
  <script src="../lib/react-dom.production.min.js"></script>
  <script src="../lib/react-dom-factories.js"></script>
  <script src="../lib/lunr.min.js"></script>
  <script type="text/javascript" src="../search.js?Thu Dec 15 21:53:36 2022"></script>
  <script type="text/javascript" src="../reference.js?Thu Dec 15 21:53:36 2022"></script>
  <script type="text/javascript">
    new L.Reference();
  </script>
</body>
</html>
